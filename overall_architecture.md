# 全体システム構成

## 構成図

```text
前の駅
電車側                                 ホーム側
+--------------+
|              |
|  Web camera  |
|              |
+-------+------+
        |
        |
+-------+------+                       +-------------------+
|              | *                   1 |  混雑度           |
| Raspberry Pi +---------------------->+  収集・共有デバイス|
|              |                       |   (PC)            |
+--------------+                       +-------------------+
                                               | 1
                                               |
次の駅                                          |
                                               | 1
                                       +-------------------+
                                       |  混雑度           |
                                       +  収集・共有デバイス | 
                                       |  (PC)             |
                                       +-------------------+
                                               | 1
                                               | (Bluetooth ブロードキャスト)
                                               | n
                                       +-------------------+
                                       |  ARグラス          |
                                       |  (まずはPC)        | 
                                       |                   |
                                       +-------------------+
```

ホームの足元にある、入口

## 各コンポーネント

### 車内にあるコンポーネント

* Web camera
  * Raspberry Piからの`fswebcom`コマンド命令で画像を撮影
  * Raspbeery PiのUSBに接続
* 加速度センサー (Accelerometer)
  * 現在の3軸加速度を計測
  * Raspberry PiのGPIOに接続
* Raspberry Pi
  * 空間認識 + 人数認識 + 混雑度算出
    * 画面内を占める頭の割合から混雑度を算出してもいい
    * 加速度センサーを取り付け、
  * 混雑度をOculus GoにBLEでブロードキャスト送信
    * 一定間隔で送信
    * もしくは、加速度センサーを取り付けて車両が停止したタイミングでブロードキャスト送信

### ホームにあるコンポーネント

* Oculus Go
  * Oculus Goのカメラで車両を認識
  * BLEブロードキャストで受け取った混雑度に応じて車両に色を付ける
